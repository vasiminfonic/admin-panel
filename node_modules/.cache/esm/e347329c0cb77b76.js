let express,mongoose,cors,path,fs,MONGODB_URL,PORT,errorHandlers,router;_0cb‍.w("express",[["default",["express"],function(v){express=v}]]);_0cb‍.w("mongoose",[["default",["mongoose"],function(v){mongoose=v}]]);_0cb‍.w("cors",[["default",["cors"],function(v){cors=v}]]);_0cb‍.w("path",[["default",["path"],function(v){path=v}]]);_0cb‍.w("fs",[["default",["fs"],function(v){fs=v}]]);_0cb‍.w("./config",[["MONGODB_URL",["MONGODB_URL"],function(v){MONGODB_URL=v}],["PORT",["PORT"],function(v){PORT=v}]]);_0cb‍.w("./middlewares/errorHandlers",[["default",["errorHandlers"],function(v){errorHandlers=v}]]);_0cb‍.w("./router",[["default",["router"],function(v){router=v}]]);









const app = express();


mongoose.connect(MONGODB_URL,{
    useCreateIndex: true,
    useNewUrlParser: true,
    useUnifiedTopology: true,
    useFindAndModify: false,
})

const db = mongoose.connection;
db.on('error', _0cb‍.g.console.error.bind(_0cb‍.g.console, 'connection error:'));
db.once('open', () => {
    console.log('DB connected...');
});

global.appRoot = path.resolve(__dirname);

app.use(cors());
app.use(express.urlencoded({ extended: false }));
app.use(express.json());

app.use('/uploads',express.static('uploads'));
app.use('/api',router);

app.use(errorHandlers);





app.use(express.static('fevison/build'))

const filePath = path.resolve(__dirname, 'react/build', 'index.html')


app.get('/*', function(request, response) {
  console.log('Home Page');
  fs.readFile(filePath, 'utf8', function (err,data) {
    if (err) {
      return _0cb‍.g.console.log(err);
    }
    data = data.replace(/\$OG_TITLE/g, 'Home Page');
    data = data.replace(/\$OG_DESCRIPTION/g, "Home page description");
    result = data.replace(/\$OG_IMAGE/g, 'https://i.imgur.com/V7irMl8.png');
    response.send(result);
  });
});



app.listen(PORT, ()=>{
    console.log(`Server Has Been Started ${PORT} `)
})